@model IEnumerable<ELF.Models.BinhLuan>

@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/NguoiDung/Views/Shared/_Layout_TrangCaNhan.cshtml";
    string avt = "";
    int maND = int.Parse(Session["maND"].ToString());
    string name = Session["HoVaTen"].ToString();
    if (Session["avatar"] != null)
    {
        avt = Session["avatar"].ToString();
    }
    else
    {
        avt = "~/images/resources/User-avatar.svg.png";
    }

    string tenNguoiDang = Session["tenNguoiDang"].ToString();
    string ngayDang = Session["ngayDang"].ToString();
    string tenSP = Session["tenSP"].ToString();
    string noiDung = Session["noiDung"].ToString();
    string hinhAnh = Session["hinhAnh"].ToString();
    string giaBan = Session["giaBan"].ToString();
    string avt_BD = Session["avt_BD"].ToString();

    int flat = int.Parse(Session["flat"].ToString());
    int maBDSP = int.Parse(Session["maBDSP"].ToString());
    int maTD = int.Parse(Session["maTD"].ToString());
    int maND_BDSP = int.Parse(Session["maND_BDSP"].ToString());
    string hidden = "";
    string avt_ND = "";
}

<div class="central-meta item">
    <div class="user-post">
        <div class="friend-info">
            <figure>
                <img src="@Url.Content(avt_BD)" alt="">
            </figure>
            <div class="friend-name">
                @if (maND != maND_BDSP)
                {
                    <ins>
                        <a href="@Url.Action("Index_TrangCaNhan_NDK", "BaiDangSanPhams",
                                new { maND_k = maND_BDSP, hoVaTen_NDK = tenNguoiDang,
                                avartar_NDK = avt_BD})" title="">@tenNguoiDang</a>
                            </ins>
                        }
                        else
                        {
                            <ins>
                                <a href="@Url.Action("Index_TrangCaNhan", "BaiDangSanPhams",
                                new { maND = maND })" title="">@tenNguoiDang</a>
                            </ins>
                        }
                <span>published: @ngayDang</span>

            </div>
            <div class="post-meta">
                <img src="@Url.Content(hinhAnh)" alt="">


                @if (flat == 1)
                {
                    using (Html.BeginForm("Delete_BL", "TraoDois"))
                    {
                        @Html.AntiForgeryToken()
                        @Html.Hidden("id", maTD)
                        <button type="submit"> Đã đăng kí </button>
                    }
                }
                else if (flat == -100)
                {

                }
                else
                {
                    using (Html.BeginForm("Create_BL", "TraoDois"))
                    {
                        @Html.AntiForgeryToken()
                        @Html.Hidden("maND", maND)
                        @Html.Hidden("maNDKhac", maND_BDSP)
                        @Html.Hidden("maBDSP", maBDSP)
                        <button type="submit"> Đăng kí </button>
                    }

                }

                <div class="description">

                    <span style="color: orangered ; font-size: 16px">
                        Tên sản phẩm: tenSP
                    </span>
                    <br />
                    <span style="color: red; font-size: 16px"> Giá sản phẩm: @giaBan đ</span>
                    <p>
                        @noiDung
                    </p>
                </div>
            </div>
        </div>

        <div class="coment-area">
            <ul class="we-comet">
                <li class="post-comment">
                    <div class="comet-avatar">
                        <img src="@Url.Content(avt)" alt="">
                    </div>
                    <div class="post-comt-box">

                        @using (Html.BeginForm("CreateBLBDSP_TrangCaNhan", "BinhLuans"))
                        {

                            @Html.AntiForgeryToken()
                            <form method="post" action="" id="myform">
                                <textarea placeholder="Post your comment" name="coment"></textarea>
                                @Html.Hidden("maND", maND)
                                @Html.Hidden("maBDSP", maBDSP)


                                <button type="submit" id="submit_cmt"></button>
                            </form>
                        }
                    </div>
                </li>
                @foreach (var item in Model)
                {

                    hidden = item.trangThai;
                    if (item.NguoiDung.avatar != null)
                    {
                        avt_ND = item.NguoiDung.avatar;
                    }
                    else
                    {
                        avt_ND = "~/images/resources/User-avatar.svg.png";
                    }
                    if (hidden == "Hien")
                    {
                        <li>
                            <div class="comet-avatar">
                                <img src="@Url.Content(avt_ND)" alt="">
                            </div>
                            <div class="we-comment">
                                <div class="coment-head">
                                    <h5><a href="time-line.html" title="">@item.NguoiDung.hoVaTen</a></h5>
                                    <span>@item.ngayBL</span>
                                    @if (item.maND == maND || item.BaiDangSanPham.maND == maND)
                                    {
                                        <div class="more">
                                            <div class="more-post-optns">
                                                <i class="ti-more-alt"></i>
                                                <ul>
                                                    <li> @Html.ActionLink("Xóa", "Delete", new { id = item.maBL }, new { onclick = "return confirm('Bạn có chắc chắn muốn xóa comment');" })</li>
                                                    @if (hidden == "An")
                                                    {
                                                        <li> @Html.ActionLink("Hiện comment", "Appear", new { id = item.maBL })</li>
                                                    }
                                                    else
                                                    {
                                                        <li> @Html.ActionLink("Ẩn comment", "Hidden", new { id = item.maBL })</li>
                                                    }

                                                </ul>
                                            </div>
                                        </div>
                                    }
                                </div>
                                <p>
                                    @item.noiDung
                                    
                                </p>
                            </div>
                        </li>
                    }
                    else if (hidden == "An" && (item.maND == maND || item.BaiDangSanPham.maND == maND))
                    {
                        <li>
                            <div class="comet-avatar">
                                <img src="@Url.Content(avt_ND)" alt="">
                            </div>
                            <div class="we-comment">
                                <div class="coment-head">
                                    <h5><a href="time-line.html" title="">@item.NguoiDung.hoVaTen</a></h5>
                                    <span>@item.ngayBL </span>
                                    <span> Đã Ẩn </span>
                                    @if (item.maND == maND || item.BaiDangSanPham.maND == maND)
                                    {
                                        <div class="more">
                                            <div class="more-post-optns">
                                                <i class="ti-more-alt"></i>
                                                <ul>
                                                    <li> @Html.ActionLink("Xóa", "Delete", new { id = item.maBL }, new { onclick = "return confirm('Bạn có chắc chắn muốn xóa comment');" })</li>
                                                    @if (hidden == "An")
                                                    {
                                                        <li> @Html.ActionLink("Hiện comment", "Appear", new { id = item.maBL })</li>
                                                    }
                                                    else
                                                    {
                                                        <li> @Html.ActionLink("Ẩn comment", "Hidden", new { id = item.maBL })</li>
                                                    }


                                                </ul>
                                            </div>
                                        </div>
                                    }
                                </div>
                                <p>
                                    @item.noiDung
                                    
                                </p>
                            </div>
                        </li>
                    }
                    else
                    {

                    }

                }

            </ul>
        </div>
    </div>
</div>



